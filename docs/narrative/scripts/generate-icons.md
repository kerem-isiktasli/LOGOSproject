# Icon Generator Script

> **Last Updated**: 2026-01-04
> **Code Location**: `scripts/generate-icons.js`
> **Status**: Active

---

## Context & Purpose

This script exists to solve a common development friction point: Electron applications require icon files in specific formats and sizes for each operating system (Windows, macOS, Linux), but developers often don't have these assets ready during early development phases. Rather than blocking the build process or requiring manual placeholder creation, this script programmatically generates valid PNG icon files.

**Business/User Need**: The LOGOS desktop application must be packaged for distribution across Windows, macOS, and Linux. The electron-builder tool requires valid icon assets to exist before packaging can succeed. This script enables developers to test the full build pipeline without waiting for final branding assets from a design team.

**When Used**:
- During initial project setup before design assets are available
- In CI/CD pipelines when testing build configurations
- By developers who need to verify packaging works on their machine
- As a template/reference for understanding PNG file format requirements

---

## Microscale: Direct Relationships

### Dependencies (What This Needs)
- `fs` (Node.js built-in): File system operations for creating directories and writing icon files
- `path` (Node.js built-in): Cross-platform path manipulation to construct correct file paths
- `zlib` (Node.js built-in): Data compression using DEFLATE algorithm (required by PNG specification)

### Dependents (What Needs This)
- `electron-builder.yml`: References the icon paths this script populates:
  - `resources/icon.ico` (Windows) - not generated by this script, needs manual creation
  - `resources/icon.icns` (macOS) - not generated by this script, needs manual creation
  - `resources/icons/*.png` (Linux) - **generated by this script**
  - `resources/icon.png` (fallback) - **generated by this script**
- `package.json` scripts: The `pack` and `dist` commands depend on icons existing

### Data Flow
```
Script execution
    |
    v
Create resources/icons/ directory (if missing)
    |
    v
For each size [16, 32, 48, 64, 128, 256, 512]:
    |
    +---> Generate PNG binary data (purple square)
    |         |
    |         +---> PNG signature (8 bytes magic number)
    |         +---> IHDR chunk (image header with dimensions)
    |         +---> IDAT chunk (compressed pixel data)
    |         +---> IEND chunk (end marker)
    |
    +---> Write to resources/icons/{size}x{size}.png
    |
    v
Generate 256x256 main icon
    |
    v
Write to resources/icon.png
    |
    v
Print completion message with production replacement instructions
```

---

## Macroscale: System Integration

### Architectural Layer

This script operates in the **Build Infrastructure Layer** of the LOGOS application:

```
Application Layers:
+--------------------------------+
| Layer 5: Distribution          | <-- Packaged installers (.exe, .dmg, .deb)
+--------------------------------+
| Layer 4: Packaging             | <-- electron-builder consumes icons HERE
+--------------------------------+
| Layer 3: Build Output          | <-- Compiled JavaScript in dist/
+--------------------------------+
| Layer 2: Source Code           | <-- TypeScript/React source files
+--------------------------------+
| Layer 1: Build Scripts         | <-- THIS SCRIPT lives here
+--------------------------------+
```

### Big Picture Impact

This utility script enables the complete developer experience for LOGOS:

1. **Enables CI/CD Pipeline**: Automated builds can run to completion without manual asset preparation
2. **Reduces Onboarding Friction**: New developers can clone the repo and immediately run `npm run dist` to test packaging
3. **Documents PNG Format**: The implementation serves as educational reference for understanding the PNG file specification (useful for debugging icon-related packaging issues)
4. **Establishes Brand Color**: Uses purple (`#6B46C1`) as placeholder, establishing the LOGOS brand color even in development builds

**System Dependencies**:
This is a **utility** component with low criticality - if it fails or is removed:
- Development builds still work (no icons needed for `npm run dev`)
- Production builds would fail only if icon files don't exist
- Can be replaced by any tool that generates PNG files (ImageMagick, GIMP, etc.)

### Critical Path Analysis

**Importance Level**: Low-Medium

- **If this fails**: Developers must manually create placeholder icons or use external tools
- **Failure mode**: Build packaging fails with "icon not found" errors
- **Backup alternatives**:
  - `electron-icon-maker` npm package
  - Online icon generators
  - Manual creation with image editing software
  - `ImageMagick convert` command-line tool

---

## Technical Concepts (Plain English)

### PNG File Format

**Technical**: PNG (Portable Network Graphics) is a lossless compressed raster image format that uses DEFLATE compression and supports transparency. It consists of an 8-byte signature followed by a series of typed chunks (IHDR, IDAT, IEND).

**Plain English**: A PNG file is like a carefully packed shipping container for images. The container starts with a special label (signature) that tells computers "this is definitely a PNG file". Inside, there are labeled compartments (chunks): one describing the image size and color type (IHDR), one containing the actual compressed picture data (IDAT), and one marking the end (IEND). Each compartment includes a checksum number to verify nothing got corrupted.

**Why We Use It**: PNG is the standard format for application icons on Linux because it supports transparency (important for non-rectangular icons) and doesn't lose quality like JPEG. Electron-builder specifically requires PNG files for Linux packaging.

### CRC32 Checksum

**Technical**: CRC32 (Cyclic Redundancy Check, 32-bit) is an error-detecting code that produces a fixed-size checksum from arbitrary data using polynomial division. PNG requires CRC32 at the end of each chunk to verify data integrity.

**Plain English**: Like a receipt total that proves all items were scanned correctly. CRC32 is a mathematical formula that turns any data into a unique 32-bit "fingerprint". If even one byte changes, the fingerprint changes completely. PNG readers use this to detect corrupted files - if the fingerprint doesn't match, something went wrong during download or storage.

**Why We Use It**: The PNG specification mandates CRC32 checksums. Without valid checksums, image viewers and electron-builder would reject our generated icons as corrupted.

### DEFLATE Compression

**Technical**: DEFLATE is a lossless data compression algorithm combining LZ77 dictionary encoding and Huffman coding. It's used in PNG's IDAT chunks via zlib wrapper.

**Plain English**: DEFLATE is like a smart packing method that finds repeated patterns and stores shortcuts instead of repeating data. If a purple pixel appears 256 times in a row, instead of writing "purple, purple, purple..." 256 times, it says "purple x 256". The Node.js zlib module does this compression automatically.

**Why We Use It**: PNG requires DEFLATE compression - it's not optional. Using Node's built-in zlib module means we don't need external dependencies to create valid PNG files.

### Placeholder Icons

**Technical**: Temporary assets used during development that satisfy tooling requirements without representing final branding.

**Plain English**: Like the "lorem ipsum" dummy text designers use in mockups. These purple squares tell electron-builder "yes, icons exist here" so the build can complete, but they're clearly not the final product. The script explicitly warns developers to replace these with real branding before production release.

**Why We Use It**: Allows parallel workstreams - developers can work on packaging and distribution while designers work on branding assets. Neither team blocks the other.

---

## Implementation Notes

### Color Choice
The script generates purple squares (`RGB: 107, 70, 193` / `#6B46C1`) which appears to be the LOGOS brand color. This ensures even placeholder icons maintain visual consistency with the application's identity.

### Size Matrix
The script generates icons at sizes `[16, 32, 48, 64, 128, 256, 512]` pixels, matching the standard sizes expected by Linux desktop environments for application icons at different DPI settings and contexts (system tray, dock, file manager, etc.).

### Platform Coverage
- **Linux**: Fully covered with PNG files in `resources/icons/`
- **Windows**: Requires manual `.ico` file creation (ICO format not generated)
- **macOS**: Requires manual `.icns` file creation (ICNS format not generated)

The script output explicitly lists which formats need manual replacement.

---

## Change History

### 2026-01-04 - Documentation Created
- **What Changed**: Created narrative documentation for this build utility script
- **Why**: Shadow Map documentation requirement for all code files
- **Impact**: Developers now have context on why this script exists and how it fits into the build system

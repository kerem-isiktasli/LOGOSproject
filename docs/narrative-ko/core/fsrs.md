# FSRS (Free Spaced Repetition Scheduler) 모듈

> **최종 업데이트**: 2026-01-07
> **코드 위치**: `src/core/fsrs.ts`
> **상태**: 활성
> **이론적 기초**: ALGORITHMIC-FOUNDATIONS.md 3부

---

## 맥락 및 목적

### 언어 학습에서 간격반복이 중요한 이유

인간의 뇌는 망각 기계입니다. 새로운 것을 배운 후 24시간 내에 약 70%를 잊습니다. 일주일 내에 90%를 잊습니다. 이것은 버그가 아니라 기능입니다. 뇌는 인지 자원을 보존하기 위해 중요하지 않다고 간주하는 정보를 공격적으로 제거합니다.

하지만 기억 과학의 반직관적인 통찰이 있습니다: **거의 잊어버릴 뻔한 것을 성공적으로 회상하는 행위가 기억을 영구적으로 만듭니다.** 망각의 가장자리에서 기억을 검색할 때마다, 그것을 인코딩하는 신경 경로를 강화합니다.

**FSRS 모듈은 언어 습득이 근본적으로 기억 문제이기 때문에 존재합니다.** 언어 학습자는 수천 개의 어휘 항목, 문법 패턴, 발음 규칙, 화용 관습을 내면화해야 합니다. 체계적인 기억 관리 없이는 학습자들이 막대한 시간을 낭비합니다:
- 이미 아는 것을 복습 (노력 낭비)
- 잊고 있는 것을 복습하지 않음 (지식 쇠퇴)

FSRS는 각 지식 조각에 대해 학습자가 다음에 언제 복습해야 하는지 정확히 예측하여 이를 해결합니다.

### FSRS 알고리즘

FSRS (Free Spaced Repetition Scheduler)는 **두 변수 기억 모델**을 사용합니다:
- **안정성 (S)**: 기억이 90% 회상 확률로 쇠퇴할 때까지의 기간
- **난이도 (D)**: 이 학습자에게 이 항목이 본질적으로 얼마나 어려운지

핵심 공식: `검색가능성 = e^(-t/S)` 여기서 t = 경과 일수, S = 안정성.

---

## FSRS가 숙달 단계 (0-4)와 어떻게 관련되는가

LOGOS는 5단계 숙달 모델을 사용합니다:

| 단계 | 이름 | 기준 |
|------|------|------|
| 0 | 미지 | 한 번도 접하지 않음 |
| 1 | 인식 | cueAssistedAccuracy >= 0.5 |
| 2 | 회상 | cueFreeAccuracy >= 0.6 OR cueAssistedAccuracy >= 0.8 |
| 3 | 통제 | cueFreeAccuracy >= 0.75 AND stability > 7일 |
| 4 | 자동 | cueFreeAccuracy >= 0.9 AND stability > 30일 AND gap < 0.1 |

FSRS 매개변수는 안정성 요구사항을 통해 단계 전환에 직접적으로 정보를 제공합니다.

---

## FSRS 평점 시스템 (1-4)

| 평점 | 이름 | LOGOS 변환 |
|------|------|------------|
| 1 | Again | 오답 |
| 2 | Hard | 단서와 함께 정답 |
| 3 | Good | 정답, 단서 없이, 느림 (>5초) |
| 4 | Easy | 정답, 단서 없이, 빠름 (<=5초) |

17개의 가중치 매개변수가 안정성 업데이트, 난이도 조정, 평점 보너스/페널티를 제어합니다.

---

## 스캐폴딩 갭 추적

LOGOS는 두 가지 정확도 지표를 추적합니다:
- **Cue-Free 정확도**: 힌트 없이의 성능
- **Cue-Assisted 정확도**: 힌트와 함께의 성능

차이가 **스캐폴딩 갭**입니다. 4단계는 gap < 0.1 (10 퍼센트 포인트)을 요구합니다.

단서 레벨 선택:
- Gap < 0.1 AND 시도 > 3: 단서 없음
- Gap < 0.2 AND 시도 > 2: 최소 단서
- Gap < 0.3: 보통 단서
- Gap >= 0.3: 전체 단서

---

## 핵심 개념 (쉬운 설명)

### 안정성 (Stability)

**기술적**: 회상 확률이 목표 유지율(90%)과 같아지는 일 단위 간격.

**쉬운 설명**: 잊을 때까지의 일수. 안정성이 30일이면 알고리즘은 약 한 달 동안 기억할 것으로 예측합니다. 높은 안정성 = 깊이 학습됨.

### 난이도 (Difficulty)

**기술적**: 0-10 척도의 항목별 학습 난이도.

**쉬운 설명**: 이 특정 항목이 이 특정 학습자에게 얼마나 끈질기게 어려운지. 높은 난이도 항목은 더 많은 반복이 필요합니다.

### 검색가능성 (Retrievability)

**기술적**: 현재 시점에서 성공적 회상 확률, 망각 곡선으로 모델링됨.

**쉬운 설명**: 지금 얼마나 기억하고 있을 것 같은지. R = 0.9이면 90% 확률로 기억함. R = 0.5이면 반반.

---

## 통합 지점

### 의존성
이 모듈은 의존성이 없습니다 - 순수 TypeScript.

### 의존처
- 세션 관리: 응답 후 `FSRS.schedule()` 호출
- 숙달 상태 시스템: `updateMastery()`와 `determineStage()` 사용
- 데이터베이스 계층: MasteryState에 FSRS 카드 필드 저장
- 우선순위 시스템: 긴급도 계산에 FSRS 상태 사용

---

## 사용 예시

```typescript
import { FSRS, createNewCard, updateMastery } from './fsrs';

const fsrs = new FSRS();
let card = createNewCard();

// 첫 복습
card = fsrs.schedule(card, 3, new Date());
console.log(card.stability);  // ~2.4일

// 다음 복습 날짜 가져오기
const nextReview = fsrs.nextReviewDate(card);
```

---

## 망각 곡선 시각화

```
회상 확률
   1.0 |*
       |  *
   0.9 |    *       <- 목표 유지율 (90%)
       |      *
   0.7 |        *
       |          *
   0.5 |            *
       |              *
   0.3 |                *
       |                  *
   0.1 |                    *   *   *
       +----------------------------> 시간 (일)
           S         2S        3S

S = 안정성 (일)
복습은 R이 90%로 떨어질 때 스케줄됨
```

---

*이 문서는 다음을 미러링합니다: `src/core/fsrs.ts`*
